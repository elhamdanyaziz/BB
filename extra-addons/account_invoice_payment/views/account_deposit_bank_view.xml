<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <record id="account_bank_deposit_form" model="ir.ui.view">
            <field name="name">account.bank.deposit.form</field>
            <field name="model">account.bank.deposit</field>
            <field name="arch" type="xml">
                <form string="Remise">
                    <header>
                        <button name="action_validate" states="draft" string="Valider la Remise" type="object" class="oe_highlight" groups="" />
                        <button name="action_deposit" states="validated" string="Remettre en Banque" type="object" class="oe_highlight" groups="" />
                        <field name="state" widget="statusbar" statusbar_visible="draft,validated,sent"/>
                    </header>
                <sheet>
                    <group>
                        <group>
                            <field name="bank_agency_code" class="oe_inline"/>
                            <field name="bank_agency_name" class="oe_inline"/>
                            <field name="account_number"/>
                            <field name="transfert_date" string="Le"/>
                            <field name="name"/>
                            <field name="amount_total"/>
                            <field name="number_check" attrs="{'invisible': [('type', '=','effect')]}" />
                            <field name="number_lcn" attrs="{'invisible': [('type', '=', 'check')]}" />
                        </group>
                        <group>
                            <field name="ref_customer"/>
                            <field name="customer_name"/>
                            <field name="type"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Détails Remise" attrs="{'invisible': [('type', '!=', 'check')]}">
                            <field name="line_lcn_ids" nolabel="1" >
                                <tree string="details" editable="bottom" >
                                    <field name="partner_id" />
                                    <field name="bank" />
                                    <field name="city" />
                                    <field name="ref_lcn" />
                                    <field name="deadline_date" />
                                    <field name="amount" />
                                    <field name="type" invisible="1"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Détails Remise" attrs="{'invisible': [('type', '!=','effect')]}">
                            <field name="line_check_ids" nolabel="1">
                                <tree string="details" editable="bottom" >
                                    <field name="partner_id" />
                                    <field name="bank" />
                                    <field name="city" />
                                    <field name="ref_check" />
                                    <field name="amount" />
                                    <field name="type" invisible="1"/>
                                </tree>
                            </field>
                        </page>
                        <div class="oe_clear"/>
                        <field name="note" placeholder="Ajouter une note..." class="oe_inline"/>
                    </notebook>
                </sheet>
                </form>
            </field>
        </record>

        <record id="account_bank_deposit_tree" model="ir.ui.view">
            <field name="name">account.bank.deposit.tree</field>
            <field name="model">account.bank.deposit</field>
            <field name="arch" type="xml">
                <tree string="Remise en Banque" create="0" delete="0">
                    <field name="name" />
                    <field name="transfert_date"/>
                    <field name="bank_agency_name" />
                    <field name="amount_total"/>
                    <field name="state" />
               </tree>
            </field>
        </record>

        <record id="account_bank_deposit_search" model="ir.ui.view">
            <field name="name">account.bank.deposit.search</field>
            <field name="model">account.bank.deposit</field>
            <field name="arch" type="xml">
                <search string="Remise en Banque">
                    <field name="name"/>
                    <field name="bank_agency_code" />
                    <field name="bank_agency_name"/>
                    <field name="transfert_date" />
                    <filter string="Brouillon" domain="[('state','=','draft')]" name="draft"/>
                    <filter string="Validé" domain="[('state','=','validated')]" name="validated"/>
                    <filter string="Remis en B  anque" domain="[('state','=','sent')]" name="sent"/>
                    <separator/>
                    <group expand="1" string="Group By">
                        <filter string="Type" icon="terp-accessories-archiver" context="{'group_by':'type'}" name='group_by_type'/>
                     </group>
                </search>
            </field>
        </record>

        <record model="ir.actions.act_window" id="action_account_bank_deposit_tree_view">
            <field name="name">Remises en Banque</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.bank.deposit</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="account_bank_deposit_search"/>
        </record>

        <menuitem id="menu_account_bank_deposit"  parent="account.menu_finance_receivables" action="action_account_bank_deposit_tree_view" sequence="16" />

    </data>
</openerp>
